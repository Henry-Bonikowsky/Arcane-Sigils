# Mummy Behavior Sigil
# Used by SPAWN_ENTITY effect to define mummy AI behaviors
# Signals: ATTACK (on hit), DEFENSE (when hit), ENTITY_DEATH (when dies), TICK (passive)

mummy_behavior:
  name: "Mummy AI"
  type: BEHAVIOR
  description:
    - "Mummy attack patterns"
    - "Applies curse and slowness on hit"

  flows:
    # When mummy attacks a target
    - type: SIGNAL
      trigger: ATTACK
      chance: 100
      cooldown: 0
      startNodeId: start
      nodes:
        - id: start
          type: START
          x: 0
          y: 0
          next: slowness
        # 50% chance to apply Pharaoh's Mark (slowness + glowing)
        - id: slowness
          type: EFFECT
          effect: POTION
          x: 0
          y: 1
          params:
            potion_type: SLOWNESS
            duration: 5
            amplifier: 1
            chance: 50
            target: '@Victim'
          next: glowing
        - id: glowing
          type: EFFECT
          effect: POTION
          x: 0
          y: 2
          params:
            potion_type: GLOWING
            duration: 5
            amplifier: 0
            chance: 50
            target: '@Victim'
          next: mark_particle
        - id: mark_particle
          type: EFFECT
          effect: PARTICLE
          x: 0
          y: 3
          params:
            particle_type: DUST
            red: 255
            green: 215
            blue: 0
            count: 10
            chance: 50
            target: '@Victim'
          next: stun
        # 10% chance to stun
        - id: stun
          type: EFFECT
          effect: STUN
          x: 0
          y: 4
          params:
            duration: 1.5
            chance: 10
            target: '@Victim'
          next: stun_msg
        - id: stun_msg
          type: EFFECT
          effect: MESSAGE
          x: 0
          y: 5
          params:
            type: ACTIONBAR
            message: '&6&lPharaoh''s Curse! &7You have been stunned!'
            chance: 10
            target: '@Victim'
          next: end
        - id: end
          type: END
          x: 0
          y: 6

    # When mummy dies
    - type: SIGNAL
      trigger: ENTITY_DEATH
      chance: 100
      startNodeId: start
      nodes:
        - id: start
          type: START
          x: 0
          y: 0
          next: death_soul
        - id: death_soul
          type: EFFECT
          effect: PARTICLE
          x: 0
          y: 1
          params:
            particle_type: SOUL
            count: 30
            target: '@Self'
          next: death_sand
        - id: death_sand
          type: EFFECT
          effect: PARTICLE
          x: 0
          y: 2
          params:
            particle_type: FALLING_DUST
            material: SAND
            count: 40
            target: '@Self'
          next: death_sound
        - id: death_sound
          type: EFFECT
          effect: SOUND
          x: 0
          y: 3
          params:
            sound: ENTITY_HUSK_DEATH
            volume: 0.8
            pitch: 0.8
            target: '@Self'
          next: end
        - id: end
          type: END
          x: 0
          y: 4
